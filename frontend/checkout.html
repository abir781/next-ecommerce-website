<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
        <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body>
     <div id="navbar" class="sticky top-0 z-50 bg-white mb-[10px]">

  </div>

    <button id="logoutBtn" class="btn btn-active btn-warning">Log out</button>

    <div class="w-9/12 mx-auto grid grid-cols-2 mt-[100px]">

        <div class="">

            <div class="">
  <label id="button2" for="address" style="display:block; margin-bottom:6px; font-weight:600;">
    Address
  </label>
 <input 
  type="text" 
  id="address" 
  name="address" 
  placeholder="Enter your address" 
  style="width:80%; padding:10px; border:1px solid #ccc; border-radius:4px; font-size:14px;"
  onkeydown="handleEnter(event)"
/>
  <button id="button1" class="bg-sky-500 px-3 py-2 text-white font-bold rounded-sm">Submit</button>
       <div id="address-container" class="mt-[20px]">
         
        </div>
</div>
            

        </div>

        
   

   

          <div id="shopping">
        <p>it's just me and no one else is allowed here</p>
    </div>

    </div>

     <h3>Amount: <input id="amount"  class="border-2 border-black" readonly></h3>
    <button onclick="pay()" class="px-4 py-2 bg-sky-500 mt-5 ml-4">Pay Now</button>
    

     <script>
   

       async function pay() {
    // 1️⃣ amount
    const amount = window.totalAmount || 0;

    // 2️⃣ cart from localStorage
    const cart = JSON.parse(localStorage.getItem('cart')) || [];

    // 3️⃣ safety check
    if (cart.length === 0) {
        alert("Cart is empty");
        return;
    }

    // 4️⃣ send to backend
    const res = await fetch('http://localhost:3000/pay', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            amount: amount,
            products: cart   // ✅ backend expects this
        })
    });

    // localStorage.removeItem("cart");

    const data = await res.json();

    // 5️⃣ redirect to SSLCommerz
    if (data.url) {
        window.location.href = data.url;
    } else {
        alert('Error: ' + data.error);
    }
}

    </script>

   
    <script src="danialves.js"></script>
    <script type="module" src="main.js"></script>
    <script type="module" src="jon.js"></script>
    <script type="module" src="login.js"></script>
    
</body>
</html>